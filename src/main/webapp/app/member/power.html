<!doctype html>
<html><head>
<meta charset="utf-8">
<title>企业权限</title>
<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0  user-scalable=yes"/>  -->
<!-- <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" > -->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport" >
<link href="../userbackstage/style/public.css" type="text/css" rel="stylesheet" />
<link href="../userbackstage/style/page.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../appcssjs/script/jquery-1.10.2.min.js"></script>
<link rel="stylesheet" href="../appcssjs/sweetalert/dist/sweetalert.css">
<script src="../appcssjs/sweetalert/dist/sweetalert-dev.js"></script>
<script src="../appcssjs/script/hammer.min.js"></script>

<script type="text/javascript" src="../appcssjs/script/tab.js"></script>
<script type="text/javascript" src="../appcssjs/script/page.js"></script>

<script type="text/javascript" src="../appcssjs/script/appendjs.js"></script>
<script type="text/javascript" src="../appcssjs/script/cache.js"></script>
<script type="text/javascript" src="../appcssjs/script/constant.js"></script>


</head>
<script type="text/javascript">
var userInfo;
JianKangCache.getGlobalData('userinfo',function(data){
		userInfo=data;
})
var userinfo = JSON.stringify(userInfo);
var uid=userInfo.userid;
function onloadData(){
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/app/getSelectPowerCompany?companyid="+userInfo.companyid,
		success:function(data){
			if(data.listone != null || data.listone.length != ""){
				var temp="<tr class=\"head_td\">"+"<td style=\"width:10%\">模块</td><td style=\"width:15%;\">权限</td><td style=\"width:40%;\">描述</td><td style=\"width:10%;\">权限状态</td><td style=\"width:15%;\">操作</td></tr>";
				for(var i= 0;i<data.listone.length;i++){
					temp += "<tr><td rowspan=\""+data.listone[i].childnum+"\">"+data.listone[i].powername+"</td>";
					if(data.datalist.length != null || data.datalist.length != ""){
						var rumnumber = 0;
						for(var j= 0;j<data.datalist.length;j++){
							if(data.listone[i].powerid == data.datalist[j].parentid){
								var info="";
								if(data.datalist[j].info.length > 30 ){
									info = data.datalist[j].info.substring(0,30)+"......";
								}else{
									info = data.datalist[j].info+"  ";
								}
								if(rumnumber == 0){
									rumnumber++;
									temp += "<td>"+data.datalist[j].powername+"</td>"+
									"<td>"+info+"<a href=\"#\" class=\"blue\"  onclick=\"details('"+data.datalist[j].powerid+"')\">详情</a></td>";
									if(data.datalist[j].edition==1){
										temp+="<td><i class=\"green\">已获得</i>（普通)</td><td>&nbsp;</td>";
									}else{
										if(data.datalist[j].result==1){
												temp += "<td><i class=\"green\">已获得</i>（专业版)</td><td>&nbsp;</td>";
										}else if(data.datalist[j].status ==2){
												temp+="<td>未获得<td><i class=\"green\">申请中</i></br>"+data.datalist[j].createtime+"</td>";
										}else{
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){
												temp+="<td>未获得<td><a href=\"#\" class=\"blue\" onclick=\"checkPweroCompany('"+data.datalist[j].powercompanyid+"')\" >申请</a></td>";	
											}
										}
									}	
								}else{
									temp += "<tr><td>"+data.datalist[j].powername+"</td>"+
									"<td>"+info+"<a href=\"#\" class=\"blue\"  onclick=\"details('"+data.datalist[j].powerid+"')\">详情</a></td>";
									if(data.datalist[j].edition==1){
										temp+="<td><i class=\"green\">已获得</i>（普通)</td><td>&nbsp;</td>";
									}else{
										if( data.datalist[j].result==1){
												temp += "<td><i class=\"green\">已获得</i>（专业版)</td><td>&nbsp;</td>";
										}else if(data.datalist[j].status ==2){
												temp+="<td>未获得<td><i class=\"green\">申请中</i>&nbsp;&nbsp;"+data.datalist[j].createtime+"</td>";
										}else{
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){
												temp+="<td>未获得<td><a href=\"#\" class=\"blue\" onclick=\"checkPweroCompany('"+data.datalist[j].powercompanyid+"')\" >申请</a></td>";	
											}
										}	
								
									}	
								}
							}
						}
				
					}
				}
				$('#modeltabs').html(temp);
			}else{
				$('#modeltabs').html("");
			}		
				
		}
	})
}

function checkPweroCompany(powercompanyid){
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/app/getPowerByCompany",
		data:"powercompanyid="+powercompanyid+"&userid="+userInfo.userid,
		success:function(data){
			if(data.status==1){
				swal({
					title : "",
					text : data.errors,
					type : "errors",
					showCancelButton : true,
					confirmButtonColor : "#ff7922",
					confirmButtonText : "确认",
					cancelButtonText : "取消",
					closeOnConfirm : true
				}, function(){
					
				})
			}else{
				swal({
					title : "",
					text :data.success,
					type : "success",
					showCancelButton : true,
					confirmButtonColor : "#ff7922",
					confirmButtonText : "确认",
					cancelButtonText : "取消",
					closeOnConfirm : true
				}, function(){
					location.href='power.html';
				})
			}
		}
	});		
}
var funid ="";
//回调函数
function callbackfunc(organizeid){
	funid = organizeid;
	if(organizeid == '' || organizeid == null){
		onloadData();
	}else{
		$.ajax({
			type:"post",
			crossDomain: true,
			dataType:"JSON",
			url:projectpath+"/app/getSelectPowerByPowerid",
			data:"organizeid="+organizeid+"&companyid="+userInfo.companyid,
			success:function(data){
				if(data.listone != null || data.listone.length != ""){
					var temp="<tr class=\"head_td\">"+"<td style=\"width:10%\">模块</td><td style=\"width:15%;\">权限</td><td style=\"width:40%;\">描述</td><td style=\"width:10%;\">权限状态</td><td style=\"width:15%;\">操作</td></tr>";
					for(var i= 0;i<data.listone.length;i++){
						temp += "<tr><td rowspan=\""+data.listone[i].childnum+"\">"+data.listone[i].powername+"</td>";
						if(data.datalist.length != null || data.datalist.length != ""){
							var rumnumber = 0;
							for(var j= 0;j<data.datalist.length;j++){
								var falg= false;
								if(data.listone[i].powerid == data.datalist[j].parentid){
									var info="";
									if(data.datalist[j].info.length > 30 ){
										info = data.datalist[j].info.substring(0,30)+"......";
									}else{
										info = data.datalist[j].info+"  ";
									}
									if(rumnumber == 0){
										rumnumber++;
										temp += "<td>"+data.datalist[j].powername+"</td>"+
										"<td>"+info+"<a href=\"#\" class=\"blue\"  onclick=\"details('"+data.datalist[j].powerid+"')\">详情</a></td>";
										if(data.datalist[j].edition==1){
											temp+="<td><i class=\"green\">已获得</i>（普通)</td>";
											falg= true;
										}else{
											if(data.datalist[j].result==1){
												temp += "<td><i class=\"green\">已获得</i>（专业版)</td>";
												falg= true;
											}else if(data.datalist[j].status ==2){
												temp+="<td>未获得</td>";
											}else{
												temp+="<td>未获得</td>";
											}
										}	
										if(data.poweruserlist!=null || data.poweruserlist.length>0){
											temp+="<td>";
											var row = 0;
											for(var p =0; p < data.poweruserlist.length ;p++){
												if(row < 3){
													if(data.datalist[j].powerid == data.poweruserlist[p].powerid){
														row ++;
														temp+="<i class=\"i_user\">"+data.poweruserlist[p].realname+",</i>";
													}
												}
											}
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){		
												if(falg){
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkfunAdd('"+data.datalist[j].powerid+"','"+data.datalist[j].powername+"')\">添加</a>";
												}else{
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkNot()\">添加</a>";
												}
											}
											temp +="</td></tr>";
										}else{
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){			
												if(falg){
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkfunAdd('"+data.datalist[j].powerid+"','"+data.datalist[j].powername+"')\">添加</a></td></tr>";
												}else{
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkNot()\">添加</a></td></tr>";
												}
											}
											temp +="</td></tr>";
										}
									}else{
										temp += "<tr><td>"+data.datalist[j].powername+"</td>"+
										"<td>"+info+"<a href=\"#\" class=\"blue\"  onclick=\"details('"+data.datalist[j].powerid+"')\">详情</a></td>";
										if(data.datalist[j].edition==1){
											temp+="<td><i class=\"green\">已获得</i>（普通)</td>";
											falg= true;
										}else{
											if( data.datalist[j].result==1){
												temp += "<td><i class=\"green\">已获得</i>（专业版)</td>";
												falg= true;
											}else if(data.datalist[j].status ==2){
												temp+="<td>未获得</td>";
											}else{
												temp+="<td>未获得</td>";
											}
											
										}	
										if(data.poweruserlist!=null || data.poweruserlist.length>0){
											temp+="<td>";
											var row = 0;
											for(var p =0; p < data.poweruserlist.length ;p++){
												if(row < 3){
													if(data.datalist[j].powerid == data.poweruserlist[p].powerid ){
														row ++;
														temp+="<i class=\"i_user\">"+data.poweruserlist[p].realname+",</i>";
													}
												}
											}
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){		
												if(falg){
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkfunAdd('"+data.datalist[j].powerid+"','"+data.datalist[j].powername+"')\">添加</a>";
												}else{
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkNot()\">添加</a>";
												}
											}
											temp +="</td></tr>";
										}else{
											if(typeof(userInfo.powerMap.power7001010) != "undefined"){			
												if(falg){
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkfunAdd('"+data.datalist[j].powerid+"','"+data.datalist[j].powername+"')\">添加</a></td></tr>";
												}else{
													temp+="<a href=\"#\" class=\"add_user\" onclick=\"checkNot()\">添加</a></td></tr>";
												}
											}
											temp +="</td></tr>";
										}
									}
								}
							}
					
						}
					}
					$('#modeltabs').html(temp);
				}else{
					$('#modeltabs').html("");
				}		
					
			}
		})
	}

}
var userlist = {};
function checkfunAdd(powerid,powername){
	showOrgan();
	userlist = {};
	$('#rangeul').html('');
	$('#usertable').html('');
	$('.tc_selrange').show();
	$('.div_mask').show();
	$('#powerid').val(powerid);
	$('#powername').val(powername);
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/app/getPowerUser",
		data:"powerid="+powerid,
		success:function(data){
			if(data.userlist.length > 0){
				$.each(data.userlist,function(i,map){
					var usermap = new Object ();
					usermap.userid = map.ownerid;
					usermap.powerid = map.powerid;
					usermap.poweruserid = map.poweruserid;
					userlist[i]=usermap;
				});
			}
		}
	});
}

function checkNot(){
	swal({
		title : "",
		text : "暂无权限,请申请权限！",
		type : "warning",
		showCancelButton : false,
		confirmButtonColor : "#ff7922",
		confirmButtonText : "确认",
		cancelButtonText : "取消",
		closeOnConfirm : true
	}, function(){
	
	});
}
//详情
function details(powerid){
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/app/getPowerByPowerid",
		data:"powerid="+powerid,
		success:function(data){
			if(data.status==1){
				swal({
					title : "",
					text : data.errors,
					type : "error",
					showCancelButton : false,
					confirmButtonColor : "#ff7922",
					confirmButtonText : "确认",
					cancelButtonText : "取消",
					closeOnConfirm : true
				}, function(){
				
				});
			}else{
				$(".div_mask").show();
				//$("#datails").css({"margin-left":"-150px","margin-top":"-600px","width":"250px","height":"250px"});
				$("#datails").css({"position":"absolute","top":"350px","left":"650px","width":"270px","height":"350px"});
				$("#datails").show();
				if(data.datalist != null && data.datalist.length>0){
					$("#powername").html(data.datalist[0].powername);
					$("#info").html(data.datalist[0].info);
				}	
			}
		}
	})
	
}


$(document).ready(function(){
	$('#nav_power').attr('class','active');$('#nav_power').parent().parent().show();
})



</script>

<script type="text/javascript">

</script>

<body onload="onloadData()">





<div class="head_box" style="background:#fff; height:43px; border-bottom:1px solid #e5e5e5; width:100%; position:fixed; left:0px; top:0px; z-index:10;">
<a class="ico_back" onclick="goBackPage()" style="position:absolute; left:15px; top:11px; width:12px; height:20px; background:url(../appcssjs/images/public/ico_back.png) no-repeat; background-size:12px 20px; text-indent:-999px; overflow:hidden;">返回</a>
<div class="name" style="text-align:center; line-height:42px; font-size:18px; color:#424242;">企业权限</div>
    
</div>

<div id="maxDiv"> 
	<div id="wholeDiv">
			<div class="main_page" style="min-height: 894px;margin-top:55px;overflow: scroll;">
			<script type="text/javascript">
			function changemenu(obj){
				if($(obj).attr("class")=="bg_hidden"){
					$(obj).parent().parent().find("ul").hide();
					$(obj).parent().parent().find("span[class=bg_show]").attr("class","bg_hidden");
					$(obj).attr("class","bg_show");
					
					$(obj).next().next().show();
				}else{
					$(obj).attr("class","bg_hidden");
					$(obj).next().next().hide();
				}
			}
			</script>
			
				  
				<input type="hidden" id="ownerid">
			    <div class="page_tab m_top">
			        <div class="tab_name"><span class="gray1">企业权限</span></div>
			        <div class="personnel">
						<div class="l_tree" id="organizetree" style="overflow:hidden;overflow-y:visible;">
						</div>
			            
			             <div class="r_list" id="userdiv">
			            	<div class="tab_list">
			                    <table width="100%" border="0" cellpadding="0" cellspacing="0" id="modeltabs" style="font-size: 12px;">
			                    </table>
			                  
			                </div> 
			              </div>    
			      
			            <div class="clear"></div>
			        </div>
			    </div>
			    <div class="div_mask" style="display:none"></div>
			</div>
			
			
			<div class="tc_detail" style="display:none;" id="datails" >
				<div class="tc_title"><span id="powername"></span><a href="#" onclick="$('.div_mask').hide();$('#datails').hide();">×</a></div>
			    <div class="p_box">
			        <p id="info"></p>
			    </div>
			    <div class="clear"></div>
			</div>
	</div>
</div>
<div class="tc_selrange" style="display:none">
	<div class="tc_title"><span>企业权限</span><a href="javascript:void(0);" onclick="$('.tc_selrange').hide();$('.div_mask').hide();">×</a></div>
    <div class="range">
    	<div class="l_box" id="new_organizetree">
    	</div>
        <div class="r_box">
        	<div class="sel_xx">
                <div class="sel_box">
                    <input type="text" class="text" placeholder="请输入姓名" id="searchrealname">
                    <input type="button" class="find_btn" value="搜索" onclick="searchuser()">
                    <div class="clear"></div>
                </div>
                <ul id="rangeul">
                </ul>
            </div>
            <div class="tab_list">
           	<input type="hidden" id="powerid">
           	<input type="hidden" id="powername"/>
            	<table width="100%" border="0" cellpadding="0" cellspacing="0" id="usertable" style="font-size: 12px;">
                	<tbody><tr class="head_td">
                    	<td width="30">&nbsp;</td>
                        <td width="70">姓名</td>
                        <td width="70">性别</td>
                        <td width="130">电话</td>
                        <td>操作</td>
                    </tr>
                </tbody></table>
            </div>
            <div class="tc_btnbox"> <a href="javascript:void(0)" onclick="submitdata()" class="bg_yellow" id="addsubmitdata">确定</a></div>
            
        </div>
        <div class="clear"></div>
    </div>
</div>
<script type="text/javascript">
function checkput(powerid){
	$("#powerid").val(powerid);
	$('.tc_selrange').show();
	$('.div_mask').show();
}

function callback(organizeid){
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/app/getNextOrgainizeById",
		data:"organizeid="+organizeid+"&companyid="+userInfo.companyid+"&userid="+userInfo.userid,
		success:function(data){
			if(data.userlist!= null && data.userlist.length >0 ){
				$('#usertable').html("<tr class=\"head_td\">"+
			        	"<td width=\"30\">&nbsp;</td>"+
			            "<td width=\"70\">姓名</td>"+
			            "<td width=\"70\">性别</td>"+
			            "<td width=\"130\">电话</td>"+
			            "<td>操作</td>"+
			        "</tr>");
				
			}
			if(data.userlist.length>0){
				var temp="";
				for(var i=0;i<data.userlist.length;i++){
					if(ownerid !=data.userlist[i].userid ){
						temp+="<tr><td class=\"img_td\"><div class=\"img\"><img src=\""+data.userlist[i].headimage+"\" width=\"30\" height=\"30\" /></div></td>"+
                        "<td>"+data.userlist[i].realname+"</td>";
                        if(data.userlist[i].sex==1){
                       		temp+="<td>男</td>";
                        }else{
                        	temp+="<td>女</td>";
                        }
                        if(data.userlist[i].isshowphone==1){
                        	 temp+="<td>"+data.userlist[i].phone+"</td>";
                        }else{
                        	var phone=data.userlist[i].phone;
                        	temp+="<td>"+phone.substring(0,3)+"*****"+phone.substring(7,phone.length)+"</td>";
                        }
                        if(userlist != null ){
                        	var powerid = $("#powerid").val();
                        	var falg = true ;
                        	var poweruserid="";
                        	$.each(userlist,function(u,map){
                        		if(powerid == map.powerid){
                        			if(data.userlist[i].userid == map.userid){
                        				falg = false;
                        				poweruserid=map.poweruserid;
                        				powerid = map.powerid;
                        			}
                            	}
                        	});
                        	if(falg){
                        		temp+="<td><a href=\"javascript:void(0)\" onclick=\"adduser(this,'"+data.userlist[i].userid+"','"+data.userlist[i].realname+"')\" class=\"link\">添加</a></td></tr>";
                        	}else{
                        		temp+="<td><a href=\"javascript:void(0)\" onclick=\"canceluser('"+poweruserid+"','"+powerid+"')\" class=\"link\">取消</a></td></tr>";
                        	}
                        }else{
                        	temp+="<td><a href=\"javascript:void(0)\" onclick=\"adduser(this,'"+data.userlist[i].userid+"','"+data.userlist[i].realname+"')\" class=\"link\">添加</a></td></tr>";
                        }
					}
				
				}
				$('#usertable').append(temp);
			}
		}
	})
}

function submitdata(){
	swal({
		title : "",
		text : "确认提交",
		type : "warning",
		showCancelButton : true,
		confirmButtonColor : "#ff7922",
		confirmButtonText : "确认",
		cancelButtonText : "取消",
		closeOnConfirm : true
	}, function(){
		$('.tc_selrange').hide();$('.div_mask').hide();
		var alldata={"userlist":[]};
		$('#rangeul').find("input[name=userid]").each(function(index){
			var userlist={};
			userlist['userid']=$(this).val();
			alldata.userlist.push(userlist); 
		})
		var userlist=JSON.stringify(alldata.userlist);
		var powerid = $("#powerid").val();
		$.ajax({
			type:"post",
			dataType:"json",
			url:projectpath+"/app/updataUserByPowerId",
			data:"powerid="+powerid+"&useridlist="+userlist+"&userid="+userInfo.userid,
			beforeSend:function(a,b){
				ajaxbefore();
			},
			complete:function(a,b){
				ajaxcomplete();
			},
			success:function(data){
				if(data.status==1){
					swal({
						title : "",
						text : data.errors,
						type : "errors",
						showCancelButton : true,
						confirmButtonColor : "#ff7922",
						confirmButtonText : "确认",
						cancelButtonText : "取消",
						closeOnConfirm : true
					}, function(){
						
					})
				}else{
					callbackfunc(funid);
				}
			}
		});		
	});
}

function canceluser(poweruserid,powerid){
	swal({
		title : "",
		text : "确认取消",
		type : "warning",
		showCancelButton : true,
		confirmButtonColor : "#ff7922",
		confirmButtonText : "确认",
		cancelButtonText : "取消",
		closeOnConfirm : true
	}, function(){

		$.ajax({
			type:"post",
			dataType:"json",
			url:projectpath+"/app/updataUserByPowerId",
			data:"powerid="+powerid+"&poweruserid="+poweruserid+"&userid="+userInfo.userid,
			beforeSend:function(a,b){
				ajaxbefore();
			},
			complete:function(a,b){
				ajaxcomplete();
			},
			success:function(data){
				if(data.status==1){
					swal({
						title : "",
						text : data.errors,
						type : "errors",
						showCancelButton : true,
						confirmButtonColor : "#ff7922",
						confirmButtonText : "确认",
						cancelButtonText : "取消",
						closeOnConfirm : true
					}, function(){
						
					})
				}else{
					$('.tc_selrange').hide();$('.div_mask').hide();
					callbackfunc(funid);
				}
			}
		});		
	});
	
}


function searchuser(){
	var ownerid ="";
	ownerid = $("#ownerid").val()
	var searchrealname=$('#searchrealname').val();
	$.ajax({
		type:"post",
		dataType:"json",
		url:projectpath+"/userbackstage/getSearchUserByName",
		data:"searchrealname="+searchrealname+"&companyid="+userInfo.companyid+"&userid="+userInfo.userid,
		success:function(data){
			$('#usertable').html("<tr class=\"head_td\">"+
		        	"<td width=\"30\">&nbsp;</td>"+
		            "<td width=\"70\">姓名</td>"+
		            "<td width=\"70\">性别</td>"+
		            "<td width=\"130\">电话</td>"+
		            "<td>操作</td>"+
		        "</tr>");
			if(data.userlist.length>0){
				var temp="";
				for(var i=0;i<data.userlist.length;i++){
					if(ownerid !=data.userlist[i].userid ){
						temp+="<tr><td class=\"img_td\"><div class=\"img\"><img src=\""+data.userlist[i].headimage+"\" width=\"30\" height=\"30\" /></div></td>"+
                        "<td>"+data.userlist[i].realname+"</td>";
                        if(data.userlist[i].sex==1){
                       		temp+="<td>男</td>";
                        }else{
                        	temp+="<td>女</td>";
                        }
                        if(data.userlist[i].isshowphone==1){
                        	 temp+="<td>"+data.userlist[i].phone+"</td>";
                        }else{
                        	var phone=data.userlist[i].phone;
                        	temp+="<td>"+phone.substring(0,3)+"*****"+phone.substring(7,phone.length)+"</td>";
                        }
                        if(userlist != null ){
                        	var powerid = $("#powerid").val();
                        	var falg = true ;
                        	var poweruserid="";
                        	$.each(userlist,function(u,map){
                        		if(powerid == map.powerid){
                        			if(data.userlist[i].userid == map.userid){
                        				falg = false;
                        				poweruserid=map.poweruserid;
                        				powerid = map.powerid;
                        			}
                            	}
                        	});
                        	if(falg){
                        		temp+="<td><a href=\"javascript:void(0)\" onclick=\"adduser(this,'"+data.userlist[i].userid+"','"+data.userlist[i].realname+"')\" class=\"link\">添加</a></td></tr>";
                        	}else{
                        		temp+="<td><a href=\"javascript:void(0)\" onclick=\"canceluser('"+poweruserid+"','"+powerid+"')\" class=\"link\">取消</a></td></tr>";
                        	}
                        }else{
                        	temp+="<td><a href=\"javascript:void(0)\" onclick=\"adduser(this,'"+data.userlist[i].userid+"','"+data.userlist[i].realname+"')\" class=\"link\">添加</a></td></tr>";
                        }
					}
				
				}
				$('#usertable').append(temp);
			}
		}
	})
}

function adduser(obj,userid,realname){
	$('#rangeul').find("input[value="+userid+"]").parent().remove();
	var temp="<li><input type=\"hidden\" name=\"userid\" value=\""+userid+"\"/>"+realname+"<a class=\"del\"><img src=\"../userbackstage/images/public/del.png\" alt=\"删除\" onclick=\"deleteorganizeuser(this)\" /></a></li>";
	$('#rangeul').append(temp);
}

function deleteorganizeuser(obj){
	$(obj).parent().parent().remove();
}
</script>


<script type="text/javascript" src="../userbackstage/script/organize.js"></script>
<script type="text/javascript" src="../userbackstage/script/organize2.js"></script>
</body></html>